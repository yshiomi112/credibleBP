{% extends "global/Page.html" %}
{% block title %}ç‰ã®è‰²ã®æ¨æ¸¬ï¼ˆ{{ round_label }}ï¼‰{% endblock %}
{% block content %}



<style>
.slider-container { display:flex; justify-content:space-between; gap:40px; margin-bottom:30px; }
.slider-box { flex:1; }
.color-slider {
  -webkit-appearance:none; width:100%; height:20px; border-radius:10px;
  background:linear-gradient(to right,#ff6666 50%,#66ccff 50%);
  outline:none; margin-top:10px;
}
.color-slider.disabled::-webkit-slider-thumb { display:none; }
.prob-value {
  display:inline-block; padding:4px 8px; font-size:1.5em; font-weight:bold;
  border:2px solid #ccc; border-radius:6px; margin-right:5px;
}
.message-line { margin-bottom:10px; line-height:1.8; }
.distribution-container {
  display:flex; justify-content:space-between; align-items:center;
  gap:40px; margin-top:20px;
}
.inline-field { display:inline-block; vertical-align:middle; margin:0 6px; }

#countdown-timer-box {
  background-color: #fff4cc;
  border-radius: 10px;
  padding: 12px 20px;
  font-size: 1.2em;
  font-weight: bold;
  color: #444;
  text-align: center;
  margin: 20px 0;
}
#timeout-warning {
  display: none;
  background: #ffe0e0;
  border-radius: 10px;
  padding: 10px 20px;
  margin: 20px 0;
  font-weight: bold;
  text-align: center;
  color: #800000;
}

.box-wrapper {
  background-color: #fdfdfd;
  border: 1px solid #888;
  border-radius: 12px;
  padding: 20px;
  margin: 20px 0;
}
.box-wrapper.light {
  border: 1px solid #ccc;   /* â† éã‚¢ã‚¯ãƒ†ã‚£ãƒ–ãªæ ã¯è–„ã„ã‚°ãƒ¬ãƒ¼ã« */
}
.box-heading {
  font-size: 1.2em;
  font-weight: bold;
  margin-bottom: 12px;
}

.inline-choice-row {
  display: flex;
  align-items: center;
  gap: 16px;
  flex-wrap: wrap;
  margin: 16px 0;
}
.button-group {
  display: flex;
  gap: 10px;
}
.choice-button {
  padding: 10px 20px;
  border: 2px solid #999;
  border-radius: 10px;
  font-size: 1.1em;
  font-weight: bold;
  cursor: pointer;
  background-color: white;
  color: #666;
  transition: all 0.3s ease;
}
input[type="radio"] { display: none; }
input[type="radio"]:checked + .choice-button.red {
  background-color: #ffdddd;
  border-color: #ff6666;
  color: #cc0000;
}
input[type="radio"]:checked + .choice-button.blue {
  background-color: #ddeeff;
  border-color: #66ccff;
  color: #0044cc;
}
</style>

<!-- ğŸ”¸ã‚¿ã‚¤ãƒãƒ¼è¡¨ç¤º -->
{# â–¼â–¼â–¼ ã‚¿ã‚¤ãƒãƒ¼è¡¨ç¤ºï¼šæœ¬ç•ªãƒ©ã‚¦ãƒ³ãƒ‰ã ã‘ â–¼â–¼â–¼ #}
{% if player.round_number not in [1, 2] %}
  <div id="countdown-timer-box">
    âŒ›ï¸ ã“ã®ãƒšãƒ¼ã‚¸ã§ã®æ®‹ã‚Šæ™‚é–“ <strong id="time-left">1:00</strong>
  </div>
  <div id="timeout-warning">
    â° æ™‚é–“ãŒçµŒéã—ã¾ã—ãŸã€‚ãªã‚‹ã¹ãæ—©ãé¸æŠã—ã¦ãã ã•ã„ã€‚
  </div>
{% endif %}
{% if player.round_number in [1, 2] %}
  <p style="color:red; font-weight:bold;">â€»ã“ã‚Œã¯ç·´ç¿’ãƒ©ã‚¦ãƒ³ãƒ‰ã§ã™ã€‚ç·´ç¿’ãƒ©ã‚¦ãƒ³ãƒ‰ã®çµæœã¯å ±é…¬ã«å½±éŸ¿ã‚’ä¸ãˆã¾ã›ã‚“ã€‚</p>
{% endif %}
<p>ä¸‹ã®æ å†…ã«ã¯é€ä¿¡è€…ãŒè¨­è¨ˆã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ—ãƒ©ãƒ³ã¨ã€ãã‚Œã‹ã‚‰è¨ˆç®—ã•ã‚Œã‚‹å…¨ä½“ã§ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ç¢ºç‡ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã¾ã™ã€‚</p>



<!-- ğŸ”¸ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ—ãƒ©ãƒ³ã¨å…¨ä½“ã§ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ç¢ºç‡ -->
<div class="box-wrapper light">
  <h3 class="box-heading">é€ä¿¡è€…ãŒè¨­è¨ˆã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ—ãƒ©ãƒ³</h3>
  <div class="slider-container">
    <!-- èµ¤ç‰ -->
    <div class="slider-box">
      <p><strong><span style="color:#ff6666">èµ¤ç‰</span>ãŒå¼•ã‹ã‚ŒãŸå ´åˆï¼š</strong></p>
      <input type="range" min="0" max="100" id="sliderR" class="color-slider disabled" disabled>
      <p class="message-line">
        <span class="prob-value" id="valueR">{{ pi_r_given_R }}</span>ï¼…ã®ç¢ºç‡ã§ã€Œ<strong style="color:#ff6666">èµ¤è‰²</strong>ã€ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡
      </p>
      <p class="message-line">
        <span class="prob-value" id="valueRB">{{ pi_b_given_R }}</span>ï¼…ã®ç¢ºç‡ã§ã€Œ<strong style="color:#66ccff">é’è‰²</strong>ã€ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡
      </p>
    </div>
    <!-- é’ç‰ -->
    <div class="slider-box">
      <p><strong><span style="color:#66ccff">é’ç‰</span>ãŒå¼•ã‹ã‚ŒãŸå ´åˆï¼š</strong></p>
      <input type="range" min="0" max="100" id="sliderB" class="color-slider disabled" disabled>
      <p class="message-line">
        <span class="prob-value" id="valueB">{{ pi_r_given_B }}</span>ï¼…ã®ç¢ºç‡ã§ã€Œ<strong style="color:#ff6666">èµ¤è‰²</strong>ã€ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡
      </p>
      <p class="message-line">
        <span class="prob-value" id="valueBB">{{ pi_b_given_B }}</span>ï¼…ã®ç¢ºç‡ã§ã€Œ<strong style="color:#66ccff">é’è‰²</strong>ã€ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡
      </p>
    </div>
  </div>

  <hr>

    <h3 class="box-heading">å…¨ä½“ã§ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡ç¢ºç‡</h3>
  <input type="range" min="0" max="100" id="sliderTotal" class="color-slider disabled" disabled>
  <div class="distribution-container">
    <p class="message-line">
      ã€Œ<strong style="color:#ff6666">èµ¤è‰²</strong>ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé€ä¿¡ã•ã‚Œã‚‹ç¢ºç‡ã¯
      <span class="prob-value">{{ marginal_r }}</span>ï¼…
    </p>
    <p class="message-line">
      ã€Œ<strong style="color:#66ccff">é’è‰²</strong>ã€ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒé€ä¿¡ã•ã‚Œã‚‹ç¢ºç‡ã¯
      <span class="prob-value">{{ marginal_b }}</span>ï¼…
    </p>
  </div>

</div>

<p>é€ä¿¡è€…ãŒè¨­è¨ˆã—ãŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒ—ãƒ©ãƒ³ã‹ã‚‰é€ä¿¡ã•ã‚Œã‚‹ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãŒã€Œ<strong style="color:#ff6666">èµ¤è‰²</strong>ã€ã®å ´åˆã¨
  ã€Œ<strong style="color:#66ccff">é’è‰²</strong>ã€ã®å ´åˆãã‚Œãã‚Œã«ã¤ã„ã¦ã€ç‰ã®è‰²ã‚’æ¨æ¸¬ã—ã¦ãã ã•ã„ã€‚</p>

<!-- ğŸ”¸è¡Œå‹•é¸æŠï¼ˆæˆ¦ç•¥æ³•ï¼‰ -->
<div class="box-wrapper">
  <h3 class="box-heading">ç‰ã®è‰²ã®æ¨æ¸¬</h3>
<form method="post">
  <div class="inline-choice-row">
    <span>ã€Œ<strong style="color:#ff6666">èµ¤è‰²</strong>ã€ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡ã—ãŸå ´åˆã€ã‚ãªãŸã®æ¨æ¸¬ã¯</span>
    <div class="button-group">
      <input type="radio" name="action_if_r" value="red" id="action_if_r_red" required>
      <label for="action_if_r_red" class="choice-button red">èµ¤ç‰</label>

      <input type="radio" name="action_if_r" value="blue" id="action_if_r_blue">
      <label for="action_if_r_blue" class="choice-button blue">é’ç‰</label>
    </div>
  </div>



  <div class="inline-choice-row">
    <span>ã€Œ<strong style="color:#66ccff">é’è‰²</strong>ã€ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’å—ä¿¡ã—ãŸå ´åˆã€ã‚ãªãŸã®æ¨æ¸¬ã¯</span>
    <div class="button-group">
      <input type="radio" name="action_if_b" value="red" id="action_if_b_red" required>
      <label for="action_if_b_red" class="choice-button red">èµ¤ç‰</label>

      <input type="radio" name="action_if_b" value="blue" id="action_if_b_blue">
      <label for="action_if_b_blue" class="choice-button blue">é’ç‰</label>
    </div>
  </div>
</div>

 <p>æ¨æ¸¬ãŒå®Œäº†ã—ãŸã‚‰ã€Œæ¬¡ã¸ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ãã ã•ã„ã€‚</p>

  <button class="btn btn-primary">æ¬¡ã¸</button>

<script>
function paint(slider, val){
  slider.value = val;
  slider.style.background = `linear-gradient(to right,#ff6666 ${val}%,#66ccff ${val}%)`;
}
window.addEventListener('DOMContentLoaded', () => {
  paint(document.getElementById('sliderR'), {{ pi_r_given_R }});
  paint(document.getElementById('sliderB'), {{ pi_r_given_B }});
  paint(document.getElementById('sliderTotal'), {{ marginal_r }});
});

// ã‚¿ã‚¤ãƒãƒ¼å‡¦ç†
let secondsLeft = 90;
function updateTimeDisplay() {
  const min = Math.floor(secondsLeft / 60);
  const sec = secondsLeft % 60;
  document.getElementById('time-left').textContent = `${min}:${sec.toString().padStart(2, '0')}`;
}
updateTimeDisplay();
const timer = setInterval(() => {
  secondsLeft -= 1;
  updateTimeDisplay();
  if (secondsLeft <= 0) {
    clearInterval(timer);
    document.getElementById("timeout-warning").style.display = "block";
  }
}, 1000);
</script>
{% endblock %}
